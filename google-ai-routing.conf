# Google AI 路由配置 - Surge 规则文件
# 让所有 Google AI 相关请求走美国节点

# ==================== 通用设置 ====================
[General]
# 跳过代理的域名使用真实 IP（避免 DNS 污染）
always-real-ip = *.googleapis.com, generativelanguage.googleapis.com, ai.google.dev

# 增加超时时间，适应 AI API 的长响应
test-timeout = 5

# ==================== MITM 设置（重要！）====================
[MITM]
# 跳过 Google API 的 MITM，避免 TLS 握手失败
# 使用 - 前缀表示排除
hostname = -generativelanguage.googleapis.com, -*.googleapis.com, -ai.google.dev, -*.google.dev

[Rule]
# ==================== Google AI 路由规则 ====================

# Google AI Studio 和 Gemini API
DOMAIN-SUFFIX,generativelanguage.googleapis.com,🇺🇲 美国节点
DOMAIN-SUFFIX,ai.google.dev,🇺🇲 美国节点
DOMAIN-SUFFIX,aistudio.google.com,🇺🇲 美国节点
DOMAIN-SUFFIX,makersuite.google.com,🇺🇲 美国节点

# Google Bard (现在的 Gemini)
DOMAIN-SUFFIX,bard.google.com,🇺🇲 美国节点
DOMAIN-SUFFIX,gemini.google.com,🇺🇲 美国节点

# Google Cloud AI Platform
DOMAIN-SUFFIX,aiplatform.googleapis.com,🇺🇲 美国节点
DOMAIN-SUFFIX,ml.googleapis.com,🇺🇲 美国节点

# Google Vertex AI
DOMAIN-SUFFIX,vertex-ai.googleapis.com,🇺🇲 美国节点

# Google 通用 API 域名（可选，如果上面的规则不够用）
# DOMAIN-SUFFIX,googleapis.com,🇺🇲 美国节点

# ==================== 使用说明 ====================
#
# 🚀 使用方法：
# 1. 将以上规则添加到你的 Surge 配置文件的 [Rule] 部分
# 2. 确保你有一个名为 "美国节点" 的策略组或节点
# 3. 重新加载 Surge 配置
#
# 🔧 自定义节点名称：
# 如果你的美国节点名称不是 "🇺🇲 美国节点"，请将上面所有的 "🇺🇲 美国节点" 
# 替换为你实际的节点名称，例如：
# - US
# - United States  
# - 美国-洛杉矶
# - 🇺🇸 美国
#
# 📝 策略组示例：
# [Proxy Group]
# 🇺🇲 美国节点 = select, US-1, US-2, US-3
#
# ⚠️ 注意事项：
# - 确保你的美国节点可以正常访问 Google 服务
# - 如果遇到连接问题，可以尝试不同的美国节点
# - 某些 Google AI 服务可能需要特定地区的节点
#
# 🔍 测试方法：
# 1. 配置完成后，访问 https://aistudio.google.com
# 2. 检查 Surge 日志，确认请求走了美国节点
# 3. 在 Google AI Studio 中测试 API 调用

# ==================== 高级配置（可选）====================

# 如果需要更精确的 IP 控制，可以添加以下规则：
# Google 主要 IP 段
# IP-CIDR,8.8.8.0/24,🇺🇲 美国节点
# IP-CIDR,8.8.4.0/24,🇺🇲 美国节点
# IP-CIDR,142.250.0.0/15,🇺🇲 美国节点
# IP-CIDR,172.217.0.0/16,🇺🇲 美国节点
# IP-CIDR,216.58.192.0/19,🇺🇲 美国节点

# 如果需要对特定 API 端点进行更细粒度控制：
# URL-REGEX,^https://generativelanguage\.googleapis\.com/v1/.*,🇺🇲 美国节点
# URL-REGEX,^https://ai\.google\.dev/.*,🇺🇲 美国节点