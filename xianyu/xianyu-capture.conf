# 闲鱼APP抓包辅助 - Surge 配置文件
# 用于捕获闲鱼启动时的请求，分析广告接口
# 
# 作者: Kiro Assistant
# 版本: v1.0.0
# 更新时间: 2026-01-05

# ==================== 脚本配置 ====================
[Script]

# 抓取闲鱼所有请求（用于分析广告接口）
闲鱼抓包 = type=http-response,pattern=^https?://(gw|acs|g|api)\..*\.(taobao|alicdn|goofish)\.com/,requires-body=1,max-size=0,script-path=xianyu-ad-block.js,timeout=30

# ==================== MITM 配置 ====================
[MITM]
# 闲鱼相关域名 - 抓包需要解密这些域名的HTTPS流量
hostname = %APPEND% gw.m.taobao.com, acs.m.taobao.com, g.alicdn.com, gw.alicdn.com, api.goofish.com, acs.goofish.com, gw.goofish.com

# ==================== 使用说明 ====================
# 
# 🎯 抓包步骤：
# 
# 1️⃣ 添加配置
#    - 将上述 [Script] 和 [MITM] 内容添加到你的 Surge 配置
#    - 将 xianyu-ad-block.js 放到 Surge 脚本目录
#    - 重新加载 Surge 配置
#
# 2️⃣ 准备抓包
#    - 确保 Surge 的 MITM 功能已开启
#    - 确保已安装并信任 Surge 的 CA 证书
#    - 打开 Surge 的日志查看器（方便实时查看）
#
# 3️⃣ 开始抓包
#    - 完全关闭闲鱼APP（从后台划掉）
#    - 重新打开闲鱼APP
#    - 等待启动广告出现
#
# 4️⃣ 查看结果
#    - 脚本会自动分析请求，识别可能的广告接口
#    - 发现广告相关请求时会发送通知
#    - 在 Surge 日志中查看详细的请求URL和响应数据
#
# 5️⃣ 分析数据
#    - 找到包含 "splash"、"ad"、"startup" 等关键词的请求
#    - 记录下广告接口的完整URL
#    - 复制响应JSON数据
#    - 把这些信息发给我，我帮你写精准的去广告脚本
#
# 📋 关注的信息：
#    - 请求URL（特别是路径部分）
#    - 响应JSON中的广告相关字段名
#    - 广告数据的结构（数组还是对象）
#
# ⚠️ 注意事项：
#    - 抓包脚本不会修改任何数据，只是记录
#    - 抓包完成后记得关闭此脚本，避免性能影响
#    - 如果请求太多看不过来，可以只关注通知提示的接口
